<?xml version="1.0"?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
<?xml-stylesheet href="options.css" type="text/css"?>

<dialog title="Zotero autoexporting" id="zotero-autoexporting-window" xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul" buttons="disclosure,extra2,accept,cancel" buttonlabelextra2="Apply settings and run manually for test" ondialogextra2="pref_handler.test_export();" buttonlabeldisclosure="Donate / Support / Changelog" ondialogdisclosure="pref_handler.open_url('http://rokdd.de/permanent:zotero-autoexporting');" onload="pref_handler.loadPrefs()"  ondialogcancel="pref_handler.onCancel();" ondialogaccept="pref_handler.onAccept();">

	<prefpane label="Zotero autoexporting" id="zotero-autoexporting-panel-general">

		<tabbox flex="1">
			<arrowscrollbox allowevents="true" class="tabbrowser-arrowscrollbox" orient="horizontal">
				<tabs>
					<tab id="tab_1" label="General"/>
					<tab id="tab_2" label="Export: Triggering events"/>
					<tab id="tab_3" label="Export: file format and path"/>
					<tab id="tab_3" label="Export: collections"/>
					<tab id="tab_9" label="Export: Postprocess"/>
				</tabs>
			</arrowscrollbox>
			<tabpanels flex="1">
				<tabpanel flex="1" orient="vertical" >
					<checkbox label="Log message to console to encounter problems" id="zotero-autoexporting-showdebug"/>
					<checkbox  label="Deactivate exporting to file in general" id="zotero-autoexporting-filedeactivate"/>
					<description width="350">If you are enable the box above, the addon does not export anything to file. So normal uncheck this option and setup the triggering events in the next tab, which starts the export. You can also run the process manually by the menu item in Zotero or in the toolbar.</description>

				</tabpanel>
				<tabpanel flex="1" orient="vertical" ><groupbox>
						<caption label="Trigger by events"/>
						<checkbox  label="export when items are added, removed or updated" id="zotero-autoexporting-file-event-trigger"/>
						<description>Hint: To avoid a lack of performance, the export starts after 5 seconds to wait for pending changes. Note that some changes like rearranging to collections is not noticed.</description>
					</groupbox>
					<groupbox>
						<caption label="Trigger by timer"/>

						<checkbox  label="export by timer" id="zotero-autoexporting-file-event-timer"/>
						<checkbox  label="try to keep the time interval between startups" id="zotero-autoexporting-file-bool-keep-interval"/>
						<hbox align="left"><label class="thlabel" control="zoteroautoexporting.fileinterval" orient="horizontal" value="Minutes between saving"/><textbox  min="3" size="4" type="number" id="zotero-autoexporting-fileinterval"/> </hbox>

					</groupbox>
				</tabpanel>

				<tabpanel flex="1" orient="vertical" ><groupbox><caption label="Format of export to file"/>

						<hbox align="left"><label class="thlabel" value="Fileformat"  control="zoteroautoexporting.filetranslator"/>
							<menulist id="format-menu">
								<menupopup id="format-popup"/>
							</menulist>
						</hbox>
						<hbox align="left"><label class="thlabel" value="Path to file" /><textbox id="zoteroautoexporting.filepathvirtual" size="40" readonly="true"/><button oncommand="pref_handler.select_file('extensions.zoteroautoexporting.filenslfile','zoteroautoexporting.filepathvirtual','save');" label="Browse file"/><button oncommand="pref_handler.reset_file('extensions.zoteroautoexporting.filenslfile','zoteroautoexporting.filepathvirtual');" label="Reset file"/></hbox>

						<description>NEW: If you are not sure whether your options will work, you can use the test function on the bottom of this panel</description>
					</groupbox>
				</tabpanel>
				<tabpanel flex="1" orient="vertical" >

					<checkbox label="create additional files for every collection named by its name " id="zotero-autoexporting-file-bool-collection-map"/>
					<checkbox label="create additional files for every subcollection named by its name " id="zotero-autoexporting-file-bool-subcollection-map"/>

					<description>NEW: If you are not sure whether your options will work, you can use the test function on the bottom of this panel</description>
				</tabpanel>

				<tabpanel flex="1" orient="vertical" >	
					<checkbox label="Deactivate this feature " id="zotero-autoexporting-postprocess-bool"/>
					<hbox align="left"><label class="thlabel" value="Path to file" /><textbox id="zoteroautoexporting.postprocesspathvirtual" size="40" readonly="true"/><button oncommand="pref_handler.select_file('extensions.zoteroautoexporting.postprocessfile','zoteroautoexporting.postprocesspathvirtual','select');" label="Browse file"/>
						<button oncommand="pref_handler.reset_file('extensions.zoteroautoexporting.postprocessfile','zoteroautoexporting.postprocesspathvirtual');" label="Reset file"/></hbox>
				</tabpanel>

			</tabpanels>

		</tabbox>





		<groupbox>
			<hbox align="left"><textbox id="zoteroautoexporting.filestatus" size="60" rows="10" cols="120" multiline="true" readonly="true"/></hbox>
			<!--<button label="Reload log" oncommand="pref_handler.init_status();"/>-->
			<caption label="Test your settings"/>
			<description>You are able to test your settings with button below. You should get a message if process finished and a detailed log into the box above. Please note that it will work like normal and overrides or all files!</description>
		</groupbox>
		<groupbox>
			<caption label="Support and development"/>
			<description>If you are experiencing a problem or any issue so tell me with lower right button, to improve the quality of addon. If you like this addon, do not hesitate to write your opinion or to contribute.</description>
		</groupbox>

	</prefpane>
	<script type="application/x-javascript" src="commons.js"/>
</dialog>